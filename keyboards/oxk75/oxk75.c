// Copyright 2023 QMK
// SPDX-License-Identifier: GPL-2.0-or-later

#include "host.h"
#include "led.h"
#include "oxk75.h"
#include "rgb_matrix_types.h"
#include "ws2812.h"

/* LED Matrix */

led_config_t g_led_config = {
    {
        {0,     1,      2,      3,      4,      5,      6,      7,      8,      9,      10,     11,     12,     13,     14,     15},       // first row
        {16,    17,     18,     19,     20,     21,     22,     23,     24,     25,     26,     27,     28,     29,     NO_LED, 30}, // second row
        {31,    32,     33,     34,     35,     36,     37,     38,     39,     40,     41,     42,     43,     NO_LED, 44,     45}, // third row
        {47,    48,     49,     50,     51,     52,     53,     54,     55,     56,     57,     58,     NO_LED, 59,     NO_LED, 60}, // fourth row
        {61,    62,     63,     64,     65,     66,     67,     68,     69,     70,     71,     NO_LED, 72,     NO_LED, 73,     74},     // fifth row
        {75,    76,     77,     NO_LED, NO_LED, 78,     NO_LED, NO_LED, NO_LED, 79,     80,     NO_LED, 81,     82,     83,     84}                      // sixth row
    },
    {
            {0, 0},    {12, 0},    {24, 0},    {36, 0}, {48, 0},  {60, 0},   {72, 0},   {84, 0},   {96, 0},   {108, 0},   {120, 0},   {132, 0},   {144, 0},   {156, 0},   {168, 0},  {180, 0},  
            {0, 12},  {12, 12},  {24, 12},  {36, 12},  {48, 12},  {60, 12},  {72, 12},  {84, 12},  {96, 12},  {108, 12},  {120, 12},  {132, 12},  {144, 12},        {162, 12},       {180, 12},  
            {3, 24},            {18, 24}, {30, 24}, {42, 24}, {54, 24},  {66, 24},  {78, 24},  {90, 24},  {102, 24},  {114, 24},  {126, 24},  {138, 24},  {150, 24},   {165, 24},    {180, 24},
{0, 40},{3, 36},     {18, 36}, {30, 36},      {42, 36},       {54, 36},  {66, 36},  {78, 36},  {90, 36},  {102, 36},  {114, 36},  {126, 36},  {138, 36},          {159, 36},         {180, 36},
            {6, 48},                   {24, 48}, {36, 48}, {48, 48}, {60, 48}, {72, 48}, {84, 48}, {96, 48},  {108, 48},  {120, 48},  {132, 48},        {150, 48},       {168, 48},  {180, 48},
            {1, 60},    {16, 60},    {31, 60},                          {72, 60},                             {112, 60},  {127, 60},             {142, 60},  {156, 60},  {168, 60},  {180, 60}
    },
    {
        4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
        4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
        4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
        8, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
        4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
        4, 4, 4, 4, 4, 4, 4, 4, 4, 4
    }
};

// Capslock LED
bool led_update_kb(led_t led_state) {
    bool res = led_update_user(led_state);
    if (res) {
        if (led_state.caps_lock) {
            ws2812_set_color(46, 10, 10, 255); // Blue
        } else {
            ws2812_set_color_all(0, 0, 0);
        }
        ws2812_flush();
    }
    return res;
}

bool rgb_matrix_indicators_kb(void) {
    if (!rgb_matrix_indicators_user()) {
        return false;
    }
    // ws2812_set_color_all(200, 200, 200);
    if (host_keyboard_led_state().caps_lock) {
        ws2812_set_color(46, 10, 10, 255); // Blue
        ws2812_flush();
        return true;
    }
    return false;
}